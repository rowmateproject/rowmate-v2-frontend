import{x as C,y as f,ap as D,c as V,w as s,ak as $,o as _,a as e,f as T,V as y,K as x,d as g,p as U,D as A,F as E,h,Z as N,a1 as P,I as i,u,al as L,e as S,i as R,C as I,a3 as m,a9 as w,z as p}from"./index.45972e7f.js";import{_ as M}from"./SectionFullScreen.021d3674.js";import{_ as t}from"./FormField.010a5606.js";import{_ as F}from"./BaseButtons.ed2c56ce.js";const z=h("h2",{class:"text-center text-3xl"},"Register",-1),j={class:"flex items-center justify-center w-full"},H={class:"flex items-center justify-center w-full p-4"},q={__name:"RegisterView",setup(O){const r=C();r.fetchConfig();const b=f({is_circle:!0,topType:"NoHair",accessoriesType:"Blank",hairColor:"Black",facialHairType:"Blank",clotheType:"BlazerShirt",eyeType:"Default",eyebrowType:"Default",mouthType:"Default",skinColor:"Light",topColor:"Black",graphicType:"Deer",facialHairColor:"Black",clotheColor:"Black",circleColor:"6fb8e0"}),o=f({email:"",password:"",password2:"",firstname:"",lastname:"",yob:1970,lang:r.lang}),n=f({errors:[]}),k=L();D(()=>{r.$patch({lang:o.lang})});const B=()=>{var d=new FormData;d.append("username",o.login),d.append("password",o.pass),p.post(`${r.api}/auth/jwt/login`,d).then(a=>{r.setAccessToken("Bearer "+a.data.access_token),p.defaults.baseURL=r.api,p.defaults.headers.common.Authorization="Bearer "+a.data.access_token,p.get("/users/me").then(c=>{r.setUser(c.data)}).then(function(){k.push("/dashboard")})}).catch(a=>{a.response&&(a.response.status==422?n.errors.push("Field validation error"):a.response.data.detail=="LOGIN_BAD_CREDENTIALS"?n.errors.push("Wrong login"):(a.response.data.detail="LOGIN_USER_NOT_VERIFIED")&&n.errors.push("User is not verified. Make sure that you have verified your E-Mail-Address and that the organisation has accepted your Account."),n.errors=n.errors.slice(-3))})};return(d,a)=>(_(),V($,null,{default:s(()=>[e(M,{bg:"purplePink"},{default:s(({cardClass:c})=>[e(T,{class:y(c),"is-form":"",onSubmit:x(B,["prevent"])},{footer:s(()=>[e(F,null,{default:s(()=>[e(g,{type:"submit",color:"info",label:"Login"}),e(g,{to:"/dashboard",color:"info",outline:"",label:"Back"})]),_:1})]),default:s(()=>[(_(!0),U(E,null,A(n.errors,(l,v)=>(_(),V(S,{onDeleted:G=>n.errors.splice(v,1),key:n.errors,color:"danger"},{default:s(()=>[R(I(l),1)]),_:2},1032,["onDeleted"]))),128)),z,h("div",j,[e(N,{avatar:b},null,8,["avatar"])]),h("div",H,[e(g,{type:"submit",color:"info",label:"Change Avatar"})]),e(P),e(t,null,{default:s(()=>[e(t,{label:"Vorname",help:"Please enter your first name"},{default:s(()=>[e(i,{modelValue:o.firstname,"onUpdate:modelValue":a[0]||(a[0]=l=>o.firstname=l),icon:u(m),name:"login",autocomplete:"firstname"},null,8,["modelValue","icon"])]),_:1}),e(t,{label:"Nachname",help:"Please enter your last name"},{default:s(()=>[e(i,{modelValue:o.lastname,"onUpdate:modelValue":a[1]||(a[1]=l=>o.lastname=l),icon:u(m),name:"login",autocomplete:"lastname"},null,8,["modelValue","icon"])]),_:1})]),_:1}),e(t,{label:"E-Mail",help:"Please enter your E-Mail-Address"},{default:s(()=>[e(i,{modelValue:o.email,"onUpdate:modelValue":a[2]||(a[2]=l=>o.email=l),icon:u(m),name:"login",autocomplete:"username"},null,8,["modelValue","icon"])]),_:1}),e(t,{label:"Password",help:"Please enter your password"},{default:s(()=>[e(i,{modelValue:o.password,"onUpdate:modelValue":a[3]||(a[3]=l=>o.password=l),icon:u(w),type:"password",name:"password",class:y(""),autocomplete:"current-password"},null,8,["modelValue","icon"])]),_:1}),e(t,{label:"Confirm Password",help:"Please enter your password"},{default:s(()=>[e(i,{modelValue:o.password2,"onUpdate:modelValue":a[4]||(a[4]=l=>o.password2=l),icon:u(w),type:"password",name:"password",class:y(""),autocomplete:"current-password"},null,8,["modelValue","icon"])]),_:1}),e(t,null,{default:s(()=>[e(t,{label:"Year",help:"Please enter your year of birth"},{default:s(()=>[e(i,{modelValue:o.yob,"onUpdate:modelValue":a[5]||(a[5]=l=>o.yob=l),type:"number",icon:u(m),name:"login",autocomplete:"username"},null,8,["modelValue","icon"])]),_:1}),e(t,{label:"Language"},{default:s(()=>[e(i,{modelValue:o.lang,"onUpdate:modelValue":a[6]||(a[6]=l=>o.lang=l),options:u(r).config.langs},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:2},1032,["class","onSubmit"])]),_:1})]),_:1}))}};export{q as default};
